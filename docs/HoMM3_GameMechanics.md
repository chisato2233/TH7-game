# 英雄无敌3 游戏机制详解

> 本文档详细介绍《英雄无敌3》(Heroes of Might and Magic III) 的核心游戏机制，作为 TH7 项目的设计参考。

---

## 一、游戏概述

《英雄无敌3》是一款回合制策略游戏，玩家控制英雄在大地图上探索、收集资源、占领城镇、招募军队，并通过回合制战斗击败敌人。游戏的核心循环是：

```
探索地图 → 收集资源 → 建造城镇 → 招募军队 → 战斗征服 → 扩张领土
```

---

## 二、资源系统

### 2.1 七种资源

游戏共有 **7 种资源**，分为基础资源和魔法资源两类：

| 类型 | 资源 | 英文 | 产出建筑 | 日产量 | 用途 |
|------|------|------|----------|--------|------|
| 基础 | 金币 | Gold | 城镇大厅 | 500-4000 | 几乎所有消费 |
| 基础 | 木材 | Wood | 锯木厂 (Sawmill) | 2 | 大部分建筑 |
| 基础 | 矿石 | Ore | 矿坑 (Ore Pit) | 2 | 大部分建筑 |
| 魔法 | 水银 | Mercury | 炼金术士实验室 | 1 | 高级建筑、魔法生物 |
| 魔法 | 硫�ite | Sulfur | 硫磺沙丘 | 1 | 高级建筑、龙族单位 |
| 魔法 | 水晶 | Crystal | 水晶洞穴 | 1 | 高级建筑、巨兽单位 |
| 魔法 | 宝石 | Gems | 宝石池塘 | 1 | 高级建筑、天使单位 |

### 2.2 资源获取方式

1. **资源建筑**: 占领地图上的矿场，每日自动产出
2. **城镇产金**: 城镇大厅等级越高，每日金币产出越多
3. **地图拾取**: 地图上散落的资源堆可直接拾取
4. **市场交易**: 通过市场以一定比例兑换资源（市场越多，汇率越优惠）
5. **资源筒仓**: 城镇特殊建筑，每日产出特定资源

### 2.3 金币产出（城镇大厅等级）

| 建筑 | 每日产金 |
|------|----------|
| 村庄大厅 (Village Hall) | 500 |
| 城镇大厅 (Town Hall) | 1000 |
| 市政厅 (City Hall) | 2000 |
| 国会大厦 (Capitol) | 4000 |

> 注意：整个地图上只能拥有一座国会大厦

---

## 三、城镇系统

### 3.1 九大种族城镇

原版游戏有 8 个种族，资料片增加到 9 个：

| 城镇 | 英文 | 风格 | 特色 |
|------|------|------|------|
| 城堡 | Castle | 人类骑士 | 全能平衡，强力射手 |
| 壁垒 | Rampart | 精灵森林 | 高机动性，金库增收 |
| 塔楼 | Tower | 魔法学院 | 三个射手，强力魔法 |
| 地狱 | Inferno | 恶魔军团 | 城门传送，后期强势 |
| 墓园 | Necropolis | 亡灵大军 | 死灵术，骷髅海战术 |
| 地下城 | Dungeon | 黑暗精灵 | 多射手，黑龙无敌 |
| 据点 | Stronghold | 野蛮部落 | 高攻低防，快速扩张 |
| 要塞 | Fortress | 沼泽生物 | 毒系单位，蜻蜓强势 |
| 元素城 | Conflux | 元素生物 | 凤凰复活，元素免疫 |

### 3.2 城镇建筑类型

城镇建筑分为以下几类：

#### 3.2.1 经济建筑
| 建筑 | 功能 |
|------|------|
| 村庄大厅 → 国会大厦 | 产出金币，逐级翻倍 |
| 市场 (Marketplace) | 资源交易（每多一个市场汇率更优） |
| 资源筒仓 (Resource Silo) | 每日产出特定魔法资源 |
| 金库 (仅壁垒) | 额外 10% 金币收入 |

#### 3.2.2 军事建筑
| 建筑 | 功能 |
|------|------|
| 堡垒 (Fort) | 解锁城墙防御，可建造兵种建筑 |
| 城堡 (Citadel) | 升级城墙，生物产量 +50% |
| 要塞 (Castle) | 最高城墙，生物产量 +100%，箭塔 |
| 生物巢穴 (Dwelling) | 每周产出对应等级生物 |

#### 3.2.3 魔法建筑
| 建筑 | 功能 |
|------|------|
| 魔法行会 1-5 级 | 解锁对应等级法术 |
| 图书馆 (仅塔楼) | 魔法行会额外 +1 法术 |

#### 3.2.4 辅助建筑
| 建筑 | 功能 |
|------|------|
| 酒馆 (Tavern) | 招募英雄 |
| 铁匠铺 (Blacksmith) | 购买战争机器 |
| 船坞 (Shipyard) | 建造船只 |

### 3.3 建筑树（前置依赖）

建筑之间存在前置依赖关系，例如：

```
村庄大厅 → 城镇大厅 → 市政厅 → 国会大厦
           ↓
         酒馆 → 码头
           ↓
         市场 → 资源筒仓
```

```
堡垒 → 城堡 → 要塞
  ↓
1级兵营 → 2级兵营 → ... → 7级兵营
```

每个城镇**每天只能建造一座建筑**，建造顺序的决策非常关键。

### 3.4 生物产量

每周第一天，所有生物巢穴会刷新可招募的生物数量：

| 生物等级 | 基础周产量 | 城堡加成后 |
|----------|------------|------------|
| 1 级 | 14-22 | 28-44 |
| 2 级 | 9-12 | 18-24 |
| 3 级 | 7-9 | 14-18 |
| 4 级 | 4-6 | 8-12 |
| 5 级 | 3 | 6 |
| 6 级 | 2 | 4 |
| 7 级 | 1 | 2 |

**增加产量的方式**:
- 城堡建筑：+50%（城堡）或 +100%（要塞）
- 特殊建筑：部分城镇有"增殖建筑"（Horde Building）大幅增加特定兵种产量
- 外部巢穴：占领地图上的同类巢穴，每个 +1 周产量
- 圣杯建筑：放置圣杯后，所有生物 +50% 产量

---

## 四、英雄系统

### 4.1 英雄职业

每个城镇有两种英雄职业：

| 城镇 | 力量型英雄 | 魔法型英雄 |
|------|------------|------------|
| 城堡 | 骑士 (Knight) | 牧师 (Cleric) |
| 壁垒 | 游侠 (Ranger) | 德鲁伊 (Druid) |
| 塔楼 | 炼金术士 (Alchemist) | 巫师 (Wizard) |
| 地狱 | 恶魔领主 (Demoniac) | 异端 (Heretic) |
| 墓园 | 死亡骑士 (Death Knight) | 巫妖 (Necromancer) |
| 地下城 | 领主 (Overlord) | 术士 (Warlock) |
| 据点 | 野蛮人 (Barbarian) | 战斗法师 (Battle Mage) |
| 要塞 | 兽人 (Beastmaster) | 女巫 (Witch) |
| 元素城 | 元素使 (Planeswalker) | 元素师 (Elementalist) |

**力量型英雄**: 升级时更容易获得攻击/防御属性
**魔法型英雄**: 升级时更容易获得力量/知识属性

### 4.2 主属性（Primary Skills）

英雄有 4 项主属性，每次升级随机 +1：

| 属性 | 英文 | 效果 |
|------|------|------|
| 攻击 | Attack | 增加所有生物的伤害输出 |
| 防御 | Defense | 减少所有生物受到的伤害 |
| 力量 | Spell Power | 增加魔法伤害/持续时间 |
| 知识 | Knowledge | 增加魔法值上限（每点 +10） |

### 4.3 次级技能（Secondary Skills）

英雄最多拥有 **8 个次级技能**，每个技能有 3 个等级：初级、高级、专家级。

次级技能分为三类：

#### 战斗技能
| 技能 | 效果 |
|------|------|
| 进攻术 (Offense) | 增加近战伤害 10%/20%/30% |
| 防御术 (Armorer) | 减少受到伤害 5%/10%/15% |
| 箭术 (Archery) | 增加远程伤害 10%/25%/50% |
| 战术 (Tactics) | 战斗开始时可部署单位位置 |
| 领导术 (Leadership) | 增加士气 +1/+2/+3 |
| 幸运术 (Luck) | 增加幸运 +1/+2/+3 |
| 后勤学 (Logistics) | 增加移动力 10%/20%/30% |

#### 魔法技能
| 技能 | 效果 |
|------|------|
| 智慧 (Wisdom) | 可学习 3/4/5 级魔法 |
| 土系魔法 | 土系魔法效果增强 |
| 气系魔法 | 气系魔法效果增强 |
| 火系魔法 | 火系魔法效果增强 |
| 水系魔法 | 水系魔法效果增强 |
| 鹰眼术 (Eagle Eye) | 战斗中学习敌方魔法 |
| 学术 (Scholar) | 与友方英雄交换魔法 |

#### 冒险技能
| 技能 | 效果 |
|------|------|
| 寻路术 (Pathfinding) | 减少地形移动力惩罚 |
| 探索术 (Scouting) | 增加视野范围 |
| 航海术 (Navigation) | 增加海上移动力 |
| 外交术 (Diplomacy) | 中立生物更易加入 |
| 财富术 (Estates) | 每日额外获得金币 |
| 死灵术 (Necromancy) | 战后将敌尸转化为骷髅 |

> **重要**: 次级技能一旦学习就无法移除，技能选择是游戏中最重要的决策之一

### 4.4 英雄专长

每个英雄都有独特的专长，例如：
- 特定兵种加成（如：狮鹫专精，狮鹫攻防 +5%/等级）
- 特定魔法加成（如：闪电专精，闪电术伤害翻倍）
- 特定技能加成（如：后勤专精，后勤效果 +5%）

---

## 五、生物系统

### 5.1 生物等级

每个城镇有 7 个等级的生物，每级可升级为更强版本：

| 等级 | 定位 | 示例（城堡） | 周产量 |
|------|------|--------------|--------|
| 1 级 | 炮灰/填充 | 枪兵 → 戟兵 | 14 |
| 2 级 | 轻步兵 | 弓箭手 → 神射手 | 9 |
| 3 级 | 主力步兵 | 狮鹫 → 皇家狮鹫 | 7 |
| 4 级 | 精锐单位 | 剑士 → 十字军 | 4 |
| 5 级 | 重型单位 | 骑士 → 骑兵 | 3 |
| 6 级 | 精英单位 | 僧侣 → 圣僧 | 2 |
| 7 级 | 旗舰单位 | 天使 → 大天使 | 1 |

### 5.2 生物属性

每个生物有以下属性：

| 属性 | 说明 |
|------|------|
| 攻击 (Attack) | 影响伤害输出 |
| 防御 (Defense) | 影响伤害减免 |
| 伤害 (Damage) | 基础伤害范围 (如 5-8) |
| 生命 (Health) | 每个单位的生命值 |
| 速度 (Speed) | 决定行动顺序和移动距离 |
| 周产量 (Growth) | 每周基础产量 |
| 招募费用 | 金币 + 可能的资源消耗 |

### 5.3 生物特殊能力

常见特殊能力：

| 能力 | 效果 | 代表生物 |
|------|------|----------|
| 飞行 (Flying) | 无视地形障碍移动 | 狮鹫、天使、龙 |
| 远程 (Ranged) | 可远程攻击 | 弓箭手、法师 |
| 二次攻击 | 一次行动攻击两次 | 神射手、冠军 |
| 无反击 | 攻击不会被反击 | 刺客、九头蛇 |
| 魔法免疫 | 免疫特定等级魔法 | 黑龙（全免疫）|
| 再生 (Regeneration) | 每回合恢复生命 | 巨魔 |
| 诅咒/衰老 | 对敌人施加负面效果 | 木乃伊、幽灵龙 |

---

## 六、战斗系统

### 6.1 战场结构

战斗在六边形网格战场上进行：
- 标准战场：15 格宽 × 11 格高
- 攻城战：包含城墙、箭塔、城门

### 6.2 行动顺序

每回合按**速度值从高到低**决定行动顺序：
1. 速度最高的生物先行动
2. 速度相同时，攻方先行动
3. 等待 (Wait) 可延迟到本回合末尾行动

### 6.3 伤害计算

**基础公式**:
```
总伤害 = 基础伤害 × 数量 × 攻防修正 × 其他修正
```

**攻防修正**:
- 攻击 > 防御：每点差值 +5% 伤害（最高 +300%）
- 防御 > 攻击：每点差值 -2.5% 伤害（最高 -70%）

**其他修正**:
- 进攻术/箭术：+10%/20%/30%（近战）或 +10%/25%/50%（远程）
- 防御术：-5%/10%/15%
- 幸运触发：伤害 ×2
- 诅咒/祝福魔法：取最低/最高伤害

### 6.4 士气与幸运

**士气 (Morale)**: 范围 -3 到 +3
- 正士气：有几率获得额外行动（+1 = 4.17% 几率）
- 负士气：有几率跳过行动（恐慌）
- 混编不同阵营生物会降低士气
- 亡灵生物士气固定为 0

**幸运 (Luck)**: 范围 -3 到 +3
- 正幸运：有几率造成双倍伤害（+3 = 12.5% 几率）
- 负幸运：有几率造成半额伤害

### 6.5 远程攻击

远程单位特殊规则：
- 近身战：被近战单位贴身后，远程伤害减半
- 障碍惩罚：攻城战中隔墙射击伤害减半
- 弹药限制：每场战斗有限弹药（弹药车可补充）

### 6.6 魔法战斗

英雄每回合可施放一个魔法：
- 消耗魔法值 (Spell Points)
- 需要在魔法行会学习过该魔法
- 力量属性影响魔法效果

常用战斗魔法：
| 魔法 | 效果 |
|------|------|
| 减速 (Slow) | 降低目标速度 50% |
| 加速 (Haste) | 提升目标速度 |
| 祝福 (Bless) | 目标造成最大伤害 |
| 诅咒 (Curse) | 目标造成最小伤害 |
| 复活 (Resurrection) | 复活死亡单位 |
| 陨石术 (Meteor Shower) | 范围伤害 |
| 末日审判 (Armageddon) | 全场伤害（慎用） |

### 6.7 攻城战

攻城战特殊机制：
- **城墙**: 阻挡地面单位，需投石机破坏
- **箭塔**: 自动攻击进攻方单位
- **护城河**: 减速/伤害进入的单位
- **城门**: 可被攻击，破坏后可通过

---

## 七、大地图探索

### 7.1 移动力

英雄每天有固定移动点数：
- 基础：1500-1600 点（取决于最慢生物）
- 道路：消耗减少
- 困难地形：消耗增加（如沼泽、沙漠）
- 后勤学：增加 10%/20%/30%

### 7.2 可交互对象

| 对象类型 | 功能 |
|----------|------|
| 资源堆 | 一次性拾取资源 |
| 矿场 | 占领后每日产出资源 |
| 野外巢穴 | 每周产出生物可招募 |
| 宝物商店 | 购买神器 |
| 技能祭坛 | 学习次级技能 |
| 经验建筑 | 获得经验值 |
| 传送门 | 快速移动 |

### 7.3 战争迷雾

- 未探索区域被迷雾覆盖
- 英雄视野范围内可见
- 探索术技能增加视野
- 部分建筑/魔法可揭示地图

---

## 八、回合与周期

### 8.1 时间结构

```
1 个月 = 4 周
1 周 = 7 天
```

### 8.2 周循环

每周第一天 (Day 1):
1. 所有城镇生物巢穴刷新产量
2. 野外巢穴重置可招募数量
3. 酒馆刷新可雇佣英雄

### 8.3 月循环

每月第一周第一天:
- 触发月份事件（如瘟疫、生物增殖等）

---

## 九、胜利与失败

### 9.1 胜利条件

根据地图设定，常见胜利条件：
- 消灭所有敌人
- 占领特定城镇
- 找到并放置圣杯
- 击败特定英雄
- 积累特定资源

### 9.2 失败条件

- 失去所有城镇和英雄
- 特定英雄死亡（剧情关卡）
- 超过时间限制

---

## 十、TH7 设计映射

以下是英雄无敌3机制与 TH7 项目的对应关系：

| HoMM3 概念 | TH7 实现 |
|------------|----------|
| 7 种资源 | ResourceType 枚举 |
| 9 个种族 | 7 个文明 (BiomeType) |
| 城镇建筑 | BuildingConfig (ScriptableObject) |
| 7 级生物 | UnitConfig (ScriptableObject) |
| 英雄主属性 | HeroStats 结构 |
| 次级技能 | SkillConfig (ScriptableObject) |
| 回合制战斗 | BattleContext |
| 大地图探索 | WorldContext + MapManager |
| 城镇场景 | TownContext |

---

## 参考资料

- [Heroes 3 Wiki](https://heroes.thelazy.net/) - 最全面的英雄无敌3维基
- [GameFAQs 攻略](https://gamefaqs.gamespot.com/pc/63965-heroes-of-might-and-magic-iii/faqs) - 详细攻略集合
- [Might and Magic Wiki](https://mightandmagic.fandom.com/) - 系列百科
- [heroesofmightandmagic.com](http://www.heroesofmightandmagic.com/heroes3/) - 策略指南
